<!doctype html>
<html>
<head>
	<title>Classification Diffusion Models</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
	<link rel="shortcut icon" type="image/x-icon" href="resources/favicon.ico">
  	<link href="style.css" rel="stylesheet" type="text/css">
	<meta property="og:title" content="Classification Diffusion Models" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
	<script src="https://kit.fontawesome.com/ad96f96272.js" crossorigin="anonymous"></script>
</head>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script type="text/javascript" async
	  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
	</script>
	<script type="text/x-mathjax-config">
	  MathJax.Hub.Config({
		tex2jax: {
		  inlineMath: [['$', '$']],
		  processEscapes: true
		}
	  });
	</script>
	<title>HTML with LaTeX</title>
  </head>
<body>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
	
	<!-- navigation bar on the top, nav bar stick to the top -->
	<nav id="navbar_top" class="navbar sticky-top navbar-expand-lg navbar-dark bg-primary" style="margin-bottom: 15px;">
		<div class="container">
				<a class="navbar-brand" href="">Classification Diffusion Models</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#main_nav">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="main_nav">
			<ul class="navbar-nav ms-auto">
				<li class="nav-item"><a class="nav-link" href="#abstract">Abstract</a></li>
				<li class="nav-item"><a class="nav-link" href="#overview">Overview</a></li>
				<li class="nav-item"><a class="nav-link" href="#numerical_evaluation">Numerical Evaluation</a></li>
				<li class="nav-item"><a class="nav-link" href="#bibtex">Bibtex</a></li>
			</ul>
			</div> 
		</div> 
		</nav>
	<!-- end nav bar -->

	<div class="container-xl"> 
		<!-- top button -->
		<button type="button" class="btn btn-danger btn-floating btn-lg" id="btn-back-to-top">
			<i class="fas fa-arrow-up"></i>
		</button>
		<!-- end top button -->

		<!-- top - author names, affiliation and links -->
		<center>
			<h1>Classification Diffusion Models: <br>Revitalizing Density Ratio Estimation</h1>
			<div class="container">
				<div class="row justify-content-md-center">
					<div class="col-md-auto">
						<span style="font-size:24px"><a href="https://www.linkedin.com/in/shahar-yadin-069725195/" target="_blank" rel="noopener noreferrer">Shahar Yadin</a></span>
					</div>
					<div class="col-md-auto">
						<span style="font-size:24px"><a href="https://noamelata.github.io/" target="_blank" rel="noopener noreferrer">Noam Elata</a></span>
					</div>
					<div class="col-md-auto">
						<span style="font-size:24px"><a href="https://tomer.net.technion.ac.il/" target="_blank" rel="noopener noreferrer">Tomer Michaeli</a></span>
					</div>
				</div>
				<p class="text-center affilation" style="font-size: 15pt;">Technion – Israel Institute of Technology&Tab;&Tab;<p>
			</div>
			

			<div class="container">
				<div class="row justify-content-md-center">
					<div class="col-md-auto">
						<span style="font-size:24px"><a class="btn btn-outline-primary" href='https://arxiv.org/abs/2402.10095' role="button"><i class="ai ai-arxiv"></i> Arxiv</a></span>
					</div>
					<div class="col-md-auto">
	    					<span style="font-size:24px">
		       					<a class="btn btn-outline-primary" href="https://github.com/shaharYadin/CDM" target="_blank" rel="noopener noreferrer">
		            					<i class="fab fa-github"></i> Code
		        				</a>
						</span>
					</div>

				</div>
			</div>
		<!-- <br> -->
		</center>
		<!-- end top -->

		<!-- abstract-->
		<hr id="abstract">
		<center>
		<h1 class="burger_h1">Abstract</h1>
		</center>
		<p>
			A prominent family of methods for learning data distributions relies on density ratio estimation (DRE), where a model is trained to <b>classify</b> between data samples and samples from some reference distribution. DRE-based models can directly output the likelihood for any given input, a highly desired property that is lacking in most generative techniques. Nevertheless, to date, DRE methods have struggled to accurately capture the distributions of complex high-dimensional data like images, which led to reduced research attention over the years.  
			In this work we present <b>classification diffusion models</b> (CDMs), a DRE-based generative method that adopts the formalism of denoising diffusion models (DDMs) while making use of a classifier that predicts the level of noise added to a clean signal. Our method is based on an analytical connection that we derive between an MSE-optimal denoiser for white Gaussian noise and a cross-entropy-optimal classifier for predicting the noise level. To the best of our knowledge, our method is the first DRE-based technique that can successfully generate images. 
			Furthermore, it can output the likelihood of any input in a single forward pass, achieving state-of-the-art negative log likelihood (NLL) among methods with this property.		
		</p>
		<!-- end abstract-->

		<!-- CDM Diagram -->
		<hr id="overview">
		<center><h1 class="burger_h1">Overview</h1></center>
		<p>
			DDMs are based on minimum-MSE (MMSE) <b>denoising</b>, while DRE methods hinge on optimal <b>classification</b>. In this work, we develop a connection between the optimal classifier for predicting the level of white Gaussian noise added to a data sample, and the MMSE denoiser for cleaning such noise. Specifically, we show that the latter can be obtained from the gradient of the former. Utilizing this connection, we propose <b>classification diffusion model</b> (CDM), a generative method that combines the formalism of DDMs, but instead of a denoiser, employs a noise-level classifier. CDM is the first instance of a DRE-based method that can successfully generate images beyond MNIST. 
			In addition, as a DRE method, CDM is inherently capable of outputting the exact log-likelihood in a single NFE. In fact, it achieves state-of-the-art negative-log-likelihood (NLL) results among methods that use a single NFE, and comparable results to computationally-expensive ODE-based methods. 
		<center>
			<h2 style="margin-top: 10px;"></h2>
			<div class="container">
				<div class="row justify-content-md-center">
					<div class="col-md-auto" style="padding: 1px;">
						<img alt="" src="./resources/arch_v5.png" class="resimage"/>
					</div>
				</div>
			</div>
		</center>
		<center><b>A diagram of CDM (right) compared with DDM (left)</b></center>
		<!-- end CDM Diagram -->
		<br>
		<br>
		<!-- CDM samples -->
		<center>
			<div class="container">
				<div class="row justify-content-md-center">
					<div class="col-md-auto" style="padding: 1px;">
						<img alt="" src="./resources/Teaser.png" style="max-width: 800px; width: 100%;"/>
					</div>
				</div>
			</div>
		</center>
		<center><b>CDM Samples from CelebA $64\times64$ and CIFAR-10</b></center>
		<p>
			
		</p>
		<!--end CDM samples -->

		<!-- Numerical Evaluations -->
		<head>
			<meta charset="UTF-8">
			<meta name="viewport" content="width=device-width, initial-scale=1.0">
			<style>
			  .table-container {
				display: flex;
				/* justify-content: space-between; */
				gap: 100px;
				
			  }
		  
			  .table-container table {
				width: 48%;
			  }
			  .table-container table:first-child {
            	border-right: 2px dashed #000; /* Add a vertical border on the right side of the first table */
        	  }

			</style>
		  </head>

		<hr id="numerical_evaluation">
		<center><h1 class="burger_h1">Numerical Evaluation</h1></center>
		<center>
			<div class="table-container">
				<!-- First Table -->			
				<table style="width:60%;">
					<caption><strong><b>NLL (bits/dim) calculated on CIFAR-10 test-set.</b> For each model we list the NFEs required for calculating the NLL.</strong></caption>
					<td colspan="3"><h4 style="color: rgba(62, 63, 63, 0.744);">Negative Log Likelihood</h4></td>
					<tr>
					<th>Model</th>
					<th>NLL &darr;</th>
					<th>NFE</th>
					</tr>
					<tr>
					<td>iResNet</td>
					<td>3.45</td>
					<td>100</td>
					</tr>
					<tr>
					<td>FFJORD</td>
					<td>3.40</td>
					<td>~3K</td>
					</tr>
					<tr>
					<td>MintNet</td>
					<td>3.32</td>
					<td>120</td>
					</tr>
					<tr>
					<td>FlowMatching</td>
					<td>2.99</td>
					<td>142</td>
					</tr>
					<tr>
					<td>VDM </td>
					<td><strong>2.65</strong></td>
					<td>10K</td>
					</tr>
					<tr>
					<td>DDPM ($L$) </td>
					<td>≤3.70</td>
					<td>1K</td>
					</tr>
					<tr>
					<td>DDPM ($L_{simple}$)</td>
					<td>≤3.75</td>
					<td>1K</td>
					</tr>
					<tr>
					<td>DDPM (SDE)</td>
					<td>3.28</td>
					<td>~200</td>
					</tr>
					<tr>
					<td>DDPM++ cont.</td>
					<td>2.99</td>
					<td>~200</td>
					</tr>
					<tr>
					<td colspan="3"><hr></td>
					</tr>
					<tr>
					<td>RealNVP </td>
					<td>3.49</td>
					<td>1</td>
					</tr>
					<tr>
					<td>Glow </td>
					<td>3.35</td>
					<td>1</td>
					</tr>
					<tr>
					<td>Residual Flow </td>
					<td>3.28</td>
					<td>1</td>
					</tr>
					<tr>
					<td>CDM</td>
					<td>3.38</td>
					<td>1</td>
					</tr>
					<tr>
					<td>CDM(unif.)</td>
					<td>2.98</td>
					<td>1</td>
					</tr>
					<tr>
					<td>CDM(OT)</td>
					<td><strong>2.89</strong></td>
					<td>1</td>
					</tr>
				</table>
			
				<!-- Second Table -->
				<table style="width:50%;">
					<caption><strong><b>Image generation quality.</b> We compare the  FID (lower is better) achieved by DDM and CDM using several sampling schemes for CelebA, unconditional CIFAR-10 and conditional CIFAR-10</strong></caption>
					<td colspan="3"><h4 style="color: rgba(62, 63, 63, 0.744);">Fréchet Inception Distance</h4></td>
					<tr>
					  <th>Sampling Method</th>
					  <th style="text-align: right;">Model</th>
					</tr>
					<tr>
					  <td colspan="2">&nbsp;</td>
					</tr>
					<!-- <tr>
					<td colspan="3"><hr></td>
					</tr> -->
					<tr>
					  <td style="color: rgb(53, 198, 235); font-weight: bold;">CelebA $64\times64$</td>
					  <td colspan="2"></td>
					</tr>
					<tr>
					  <th></th>
					  <th>DDM</th>
					  <th>CDM</th>
					</tr>
					<tr>
					  <td>DDIM Sampler, 50 steps</td>
					  <td>8.47</td>
					  <td style="font-weight: bold;">4.78</td>
					</tr>
					<tr>
					  <td>DDPM Sampler, 1000 steps</td>
					  <td>4.13</td>
					  <td style="font-weight: bold;">2.51</td>
					</tr>
					<tr>
					  <td>2nd order DPM Solver, 25 steps</td>
					  <td>6.16</td>
					  <td style="font-weight: bold;">4.45</td>
					</tr>
					<tr>
					  <td colspan="2">&nbsp;</td>
					</tr>
					<tr>
					<td colspan="3"><hr></td>
					</tr>
					<tr>
					  <td style="color: rgb(53, 198, 235); font-weight: bold;">Unconditional CIFAR-10 $32\times32$</td>
					  <td colspan="2"></td>
					</tr>
					<tr>
					  <th></th>
					  <th>DDM</th>
					  <th>CDM</th>
					</tr>
					<tr>
					  <td>DDIM Sampler, 50 steps</td>
					  <td style="font-weight: bold;">7.19</td>
					  <td>7.56</td>
					</tr>
					<tr>
					  <td>DDPM Sampler, 1000 steps</td>
					  <td>4.77</td>
					  <td style="font-weight: bold;">4.74</td>
					</tr>
					<tr>
					  <td>2nd order DPM Solver, 25 steps</td>
					  <td style="font-weight: bold;">6.91</td>
					  <td>7.29</td>
					</tr>
					<tr>
					  <td colspan="2">&nbsp;</td>
					</tr>
					<tr>
					<td colspan="3"><hr></td>
					</tr>
					<tr>
					  <td style="color: rgb(53, 198, 235); font-weight: bold;">Conditional CIFAR-10 $32\times32$</td>
					  <td colspan="2"></td>
					</tr>
					<tr>
					  <th></th>
					  <th>DDM</th>
					  <th>CDM</th>
					</tr>
					<tr>
					  <td>DDIM Sampler, 50 steps</td>
					  <td>5.92</td>
					  <td style="font-weight: bold;">5.08</td>
					</tr>
					<tr>
					  <td>DDPM Sampler, 1000 steps</td>
					  <td>4.70</td>
					  <td style="font-weight: bold;">3.66</td>
					</tr>
					<tr>
					  <td>2nd order DPM Solver, 25 steps</td>
					  <td>5.87</td>
					  <td style="font-weight: bold;">4.87</td>
					</tr>
				  </table>
				  
			  </div>
			
		</center>
		<!-- Numerical Evaluations -->
		<!-- bibtex citation -->
		<hr id="Bibtex">
		<p class="section" id="bibtex"><b>Bibtex</b></p>
		<table border="0">
		<tbody>
			<pre class="command-copy" 
			style=" display: block;
					background: #eee;
					white-space: pre;
					-webkit-overflow-scrolling: touch;
					max-width: 100%;
					min-width: 100px;
					border-radius: 20px;
					padding: 0;;">
	
	@article{yadin2024classification,
		title={Classification Diffusion Models},
		author={Yadin, Shahar and Elata, Noam and Michaeli, Tomer},
		journal={arXiv preprint arXiv:2402.10095},
		year={2024}
	  }
		</pre>
		</tbody>
		</table>
		<!-- end bibtex citation -->

		<hr>
		<br>

		<!-- acknowledgement -->
		<div class="container">
			<center><h4>Acknowledgements</h4></center>
			<p style="font-size: 11pt;">
				This webpage was originally made by <a href="https://www.linkedin.com/in/matan-kleiner/" target="_blank" rel="noopener noreferrer">Matan Kleiner</a> with the 
				help of <a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/hilamanor/">Hila Manor</a> 
				for <a target="_blank" rel="noopener noreferrer" href="https://matankleiner.github.io/sinddm/">SinDDM</a> and can be used as a <a target="_blank" rel="noopener noreferrer" href="https://github.com/matankleiner/academic-webpage-template/tree/main">template</a>.
                It is inspired by the template that was originally made by <a target="_blank" rel="noopener noreferrer" href="http://web.mit.edu/phillipi/">Phillip Isola</a> and
				<a target="_blank" rel="noopener noreferrer" href="http://richzhang.github.io/">Richard Zhang</a> for a <a target="_blank" rel="noopener noreferrer" href="http://richzhang.github.io/colorization/">colorful</a> ECCV project;
				the code for the original template can be found <a target="_blank" rel="noopener noreferrer" href="https://github.com/richzhang/webpage-template">here</a>.<br>
				<br>
				</a>
			</p>
		</div>
	<br>

</div>

<script src="functionality.js"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>
</html>

